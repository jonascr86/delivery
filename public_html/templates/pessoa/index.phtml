<?php
    use Delivery\Dao\PessoaDao;
    use Delivery\Model\Pessoa;
    $url = $this->UrlBuilder()->doAction('pessoa', ['adicionar' => TRUE]);
    $this->loadHeader();
    $pessoaDao = new PessoaDao('cliente', new Pessoa());
    $tabelas = ['id','nome', 'data_nascimento', 'cpf', 'sexo', 'celular', 'email', 'usuario'];
    $pessoas = $pessoaDao->listar($tabelas);
?>
<h1 class="page-header">Usuários 
    
    <a href="<?=$url?>" class="btn btn-primary">Adicionar Novo</a></h1>
    
    <?php if (isset($this->params['erro'])) : ?>
        <p class="bg-warning"> <?= $this->params['erro']; ?> </p>
    <?php endif; ?>

<table class="table table-bordered wcms-table">
    <thead>
        <tr>
            <th>#</th>
            <th>Nome</th>
            <th>Data nascimento</th>
            <th>CPF</th>
            <th>Sexo</th>
            <th>Celular</th>
            <th>Email</th>
            <th>Usuário</th>
        </tr>
    </thead>

    <tbody>
        <?php foreach ($pessoas as $pessoa) :?>
        <tr>
            <td><?= $pessoa['id'] ?></td>
            <td><?= $pessoa['nome'] ?></td>
            <td><?= date('d/m/Y', strtotime($pessoa['data_nascimento'])) ?></td>
            <td><?= $pessoa['cpf'] ?></td>
            <td><?= $pessoa['sexo'] = 'M' ? 'Masculino' : 'Feminino' ?></td>
            <td><?= $pessoa['celular'] ?></td>
            <td><?= $pessoa['email'] ?></td>
            <td><?= $pessoa['usuario'] ?></td>
            <td><a href="<?= $this->UrlBuilder()->doAction('pessoa', ['editar' => TRUE, 
                'id' => "{$pessoa['id']}"]);?>" class="btn btn-info">Editar</a>
                <a href="<?= $this->UrlBuilder()->doAction('pessoa', ['remover' => TRUE, 
                'id' => "{$pessoa['id']}"]);?>" class="btn btn-danger">Remover</a></td>
        </tr>
        <?php endforeach; ?>
    </tbody>
</table>
<?php $this->loadFooter();?>